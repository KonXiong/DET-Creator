module control(CP,Start,X,Done,num,CP1,CP2,rst,state);
input CP,Start,X;
input [3:0] num;
output reg Done,CP1=0,CP2=0,rst;
parameter S0=2'b00,S1=2'b01,S2=2'b10;
output reg [1:0] state=S0;

always @(posedge CP or negedge Start)
begin
	if(!Start)
		state=S0;
		rst=1;
	else
	begin
	case(state)
	S0:
		begin
		Done=0;
		state=S1;
		rst=0;
		end
	endcase
	case(state)
	S1:
		begin
		if(X==1) 
			begin
			CP2<=1;
			CP1<=1;
			end
		else 
			begin
			CP2<=0;
			CP1<=1;
			end
		if(num==4'b1111) state=S2;
		end
	endcase
	case(state)
	S2:
		begin
		Done=1;
		state=S0;
		rst=1;
		end
	endcase
	end
end
endmodule